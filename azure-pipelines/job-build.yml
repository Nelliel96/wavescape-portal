# +----------------------------------------------------------------------------
# | Copyright (c) 2022 Pivotal Commware
# | All rights reserved.
# | 
# | job-build.yml
# | reusable Azure pipeline build steps
# +----------------------------------------------------------------------------
jobs:
  - job: Api
    steps:
    - checkout: self
    - task: UsePythonVersion@0
      displayName: "Installing Python 3.9"
      inputs:
        versionSpec: '3.9'
        architecture: 'x64'
    # Update pip to latest
    - bash: python -m pip install --upgrade pip
      displayName: 'Upgrade pip'
    # Update to latest Azure CLI version, min version required for Azure DevOps is 2.10.1
    - bash: pip install --pre azure-cli --extra-index-url https://azurecliprod.blob.core.windows.net/edge
      displayName: 'Upgrade Azure CLI'
    - bash: './bin/api-build.sh'
      name: Build
    - publish: '$(Build.apiArtifact)'
      artifact: ApiPackage
      displayName: Publish Package